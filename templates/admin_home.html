{% extends "base_admin.html" %}

{% block title %}Admin Home{% endblock %}

{% block content %}
<body class="text-white">
    <div class="dashboard-container">
        <div class="main-content">
            <h1>Welcome back!</h1>
            <p class="h2">Admin Dashboard</p>
        </div>
    </div>
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}
        <!-- Bootstrap row container -->
        <div class="row">
            <!-- Left column: Creating Stocks -->
            <div class="col-md-6 mb-3 d-flex">
                <div class="card w-100" style="background-color: rgba(128, 0, 128, 0.8);">
                    <div class="card-header text-center">
                        <h5 class="text-white mb-0">Create Stocks</h5>
                    </div>
                    <div class="card-body d-flex flex-column align-items-center">
                        <form method="POST" action="{{ url_for('admin_home') }}" class="w-100 d-flex flex-column align-items-center">
                            <div class="mb-5 w-75 mt-5">
                                <input type="text" name="company_name" class="form-control" placeholder="Company Name" required>
                            </div>
                            <div class="mb-5 w-75">
                                <input type="text" name="ticker" class="form-control" placeholder="Ticker" required>
                            </div>
                            <div class="mb-5 w-75">
                                <input type="number" step="0.01" name="price" class="form-control" placeholder="Price" required>
                            </div>
                            <div class="mb-5 w-75">
                                <input type="text" name="volume" class="form-control" placeholder="Volume (Max: 99,999)">
                            </div>
                            <button type="submit" class="btn btn-success w-75">Create</button>
                        </form>
                    </div>
                </div>
            </div>
            <!-- Set Market Schedule -->
            <div class="col-md-5 mb-3">
                <div class="card" style="background-color: rgba(128, 0, 128, 0.8)">
                    <div class="card-header">
                        <h5 class="text-white mb-0">Set Market Schedule</h5>
                    </div>
                    <!-- Card body containing all form elements -->
                    <div class="card-body">
                        <!-- Current schedule display section -->
                        <div class="card-body">
                            <!-- Current market days display -->
                            <form method="POST" action="{{ url_for('update_market_schedule') }}">
                                <div class="mb-3">
                                    <label class="form-label text-white">Current Market Days</label>
                                    <input type="text" class="form-control" 
                                        value="{% if market_schedule and market_schedule.note %}{{ market_schedule.note }}{% else %}No Market Schedule Set{% endif %}" 
                                        readonly>
                                    <div class="row mt-2">
                                        <div class="col-md-6">
                                            <label class="form-label text-white small">Start Date</label>
                                            <select name="start_date" class="form-select" required>
                                                <option value="Sunday" {% if market_schedule.start_date == 'Sunday' %}selected{% endif %}>Sunday</option>
                                                <option value="Monday" {% if market_schedule.start_date == 'Monday' %}selected{% endif %}>Monday</option>
                                                <option value="Tuesday" {% if market_schedule.start_date == 'Tuesday' %}selected{% endif %}>Tuesday</option>
                                                <option value="Wednesday" {% if market_schedule.start_date == 'Wednesday' %}selected{% endif %}>Wednesday</option>
                                                <option value="Thursday" {% if market_schedule.start_date == 'Thursday' %}selected{% endif %}>Thursday</option>
                                                <option value="Friday" {% if market_schedule.start_date == 'Friday' %}selected{% endif %}>Friday</option>
                                                <option value="Saturday" {% if market_schedule.start_date == 'Saturday' %}selected{% endif %}>Saturday</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label text-white small">End Date</label>
                                            <select name="end_date" class="form-select" required>
                                                <option value="Sunday" {% if market_schedule.end_date == 'Sunday' %}selected{% endif %}>Sunday</option>
                                                <option value="Monday" {% if market_schedule.end_date == 'Monday' %}selected{% endif %}>Monday</option>
                                                <option value="Tuesday" {% if market_schedule.end_date == 'Tuesday' %}selected{% endif %}>Tuesday</option>
                                                <option value="Wednesday" {% if market_schedule.end_date == 'Wednesday' %}selected{% endif %}>Wednesday</option>
                                                <option value="Thursday" {% if market_schedule.end_date == 'Thursday' %}selected{% endif %}>Thursday</option>
                                                <option value="Friday" {% if market_schedule.end_date == 'Friday' %}selected{% endif %}>Friday</option>
                                                <option value="Saturday" {% if market_schedule.end_date == 'Saturday' %}selected{% endif %}>Saturday</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <button type="submit" class="btn btn-success">Update Operating Days</button>
                            </form>
                            <form action="{{ url_for('admin_home') }}" method="POST">
                                <h5 class="text-white mb-3">Add Market Holiday</h5>
                                <div class="mb-3">
                                    <label for="holiday_date" class="form-label text-white">Holiday Date</label>
                                    <input type="date" class="form-control" id="holiday_date" name="holiday_date" required>
                                </div>
                                <div class="mb-3">
                                    <label for="holiday_name" class="form-label text-white">Holiday Name</label>
                                    <input type="text" class="form-control" id="holiday_name" name="holiday_name" placeholder="e.g. Market Maintenance Day" required>
                                </div>
                                <button type="submit" name="add_holiday" class="btn btn-success w-100">Add Holiday</button>
                            </form>
                    </div>
                </div>
            </div><!-- End of Set Market Schedule Card --><!-- End of Set Market Schedule Card -->
        </div>
    <!-- Bottom row: Market Hours Card -->
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card" style="background-color: rgba(128, 0, 128, 0.8)">
                <div class="card-header">
                    <h5 class="text-white mb-0">Set Market Hours</h5>
                </div>
                <div class="card-body">
                    <!-- Current market hours display -->
                    <form method="POST" action="{{ url_for('update_market_hours') }}" id="marketHoursForm">
                        <div class="mb-3">
                            <label class="form-label text-white">Current Market Hours</label>
                            <input type="text" class="form-control" value="{{ market_hours.opening_time.strftime('%I:%M %p') }} - {{ market_hours.closing_time.strftime('%I:%M %p') }}" readonly>
                            <div class="row">
                                <!-- Opening time dropdowns -->
                                <div class="col-md-3">
                                    <label class="form-label text-white small">Opening Hour</label>
                                    <select name="opening_hour" class="form-select" required>
                                        <option value="6" {% if market_hours.opening_time.hour == 6 %}selected{% endif %}>6:00</option>
                                        <option value="7" {% if market_hours.opening_time.hour == 7 %}selected{% endif %}>7:00</option>
                                        <option value="8" {% if market_hours.opening_time.hour == 8 %}selected{% endif %}>8:00</option>
                                        <option value="9" {% if market_hours.opening_time.hour == 9 %}selected{% endif %}>9:00</option>
                                        <option value="10" {% if market_hours.opening_time.hour == 10 %}selected{% endif %}>10:00</option>
                                    </select>
                                </div>
                                
                                <div class="col-md-3">
                                    <label class="form-label text-white small">AM/PM</label>
                                    <select name="opening_meridiem" class="form-select" required>
                                        <option value="AM" selected>AM</option>
                                        <option value="PM">PM</option>
                                    </select>
                                </div>
                                
                                <!-- Closing time dropdowns -->
                                <div class="col-md-3">
                                    <label class="form-label text-white small">Closing Hour</label>
                                    <select name="closing_hour" class="form-select" required>
                                        <option value="3">3:00</option>
                                        <option value="4">4:00</option>
                                        <option value="5" selected>5:00</option>
                                        <option value="6">6:00</option>
                                        <option value="7">7:00</option>
                                    </select>
                                </div>
                                
                                <div class="col-md-3">
                                    <label class="form-label text-white small">AM/PM</label>
                                    <select name="closing_meridiem" class="form-select" required>
                                        <option value="AM">AM</option>
                                        <option value="PM" selected>PM</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-success">Update Hours</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</body>
{% endblock %}